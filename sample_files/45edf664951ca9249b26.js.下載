(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{269:function(e,t,n){"use strict";function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.isCivicLikerTrial||e.isSubscribedCivicLiker?"civic-liker":"none"}n.d(t,"a",(function(){return r}))},301:function(e,t,n){"use strict";n.r(t);n(69),n(55),n(57),n(61);var r=n(116),o=(n(68),n(48),n(39),n(38),n(28),n(54),n(30)),c=(n(64),n(24)),h=n(253),l=n(269);function k(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?k(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):k(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var f={mixins:[n(278).a],data:function(){return{isUserFetched:!1,isShowLikeButton:!0}},computed:{popupURL:function(){var e="/in/like/".concat(this.id,"/?referrer=").concat(encodeURIComponent(this.referrer));return this.buttonType&&(e+="&type=".concat(encodeURIComponent(this.buttonType))),e},isPreview:function(){return"1"===this.$route.query.preview}},head:function(){var link=[];return this.isUserFetched&&!this.isLoggedIn&&(this.hasCookieSupport?window.doNotTrack||navigator.doNotTrack||link.push({rel:"prefetch",href:this.signUpURL}):link.push({rel:"prefetch",href:this.popupURL})),{link:link}},mounted:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:try{window.top.postMessage({action:"MOUNTED"},this.referrer)}catch(e){console.error(e)}if(window.addEventListener("message",this.handleWindowMessage),!this.isPreview){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,regeneratorRuntime.awrap(this.getIsCookieSupport());case 6:return this.hasCookieSupport=e.sent,this.parentSuperLikeID=this.getParentSuperLikeID(),e.next=10,regeneratorRuntime.awrap(this.updateUserSignInStatus());case 10:this.onCheckCookieSupport&&this.onCheckCookieSupport(this.hasCookieSupport),this.isUserFetched=!0;case 12:case"end":return e.stop()}}),null,this)},beforeDestroy:function(){window.removeEventListener("message",this.handleWindowMessage)},watch:{referrer:function(){this.updateUserSignInStatus()}},methods:{openPopup:function(e){var t="".concat(this.popupURL,"&action=").concat(e);if(Object(r.f)()&&Object(r.g)())try{return void(window.top.location.href=t)}catch(e){console.error(e)}var n=window.open(t,"like","menubar=no,location=no,width=576,height=768");this.$root.$emit("openPopupNoticeOverlay",n)},handleWindowMessage:function(e){var data,t,n,r=this;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(data=e.data,"object"===Object(c.a)(data)){o.next=3;break}return o.abrupt("return");case 3:if(e.source!==window.parent&&e.source!==window.top){o.next=14;break}o.t0=data.action,o.next="SET_REFERRER"===o.t0?7:"DISABLE_BUTTON"===o.t0?12:14;break;case 7:if(void 0!==(t=data.content.referrer)){o.next=10;break}return o.abrupt("return");case 10:return this.$router.replace({name:this.$route.name,params:this.$route.params,hash:this.$route.hash,query:d({},this.$route.query,{referrer:t})}),o.abrupt("break",14);case 12:return this.isShowLikeButton=!1,o.abrupt("break",14);case 14:if(e.origin!=="https://".concat(h.g)){o.next=36;break}o.t1=data.action,o.next="LOGGED_IN"===o.t1?18:"PREVIEW"===o.t1?31:36;break;case 18:return o.next=20,regeneratorRuntime.awrap(this.updateUserSignInStatus());case 20:o.t2=this.postSignInAction,o.next="like"===o.t2?23:"save"===o.t2?25:"follow"===o.t2?27:29;break;case 23:return this.$nextTick((function(){r.$refs.likeButton&&r.$refs.likeButton.onClick()})),o.abrupt("break",30);case 25:return this.hasBookmarked||this.onClickSaveButton(),o.abrupt("break",30);case 27:return this.hasFollowedCreator||this.onClickFollowButton(),o.abrupt("break",30);case 29:return o.abrupt("break",30);case 30:return o.abrupt("break",36);case 31:if(this.isPreview){o.next=33;break}return o.abrupt("return");case 33:return(n=data.content.user)&&(n.user&&(this.id=n.user),n.displayName&&(this.displayName=n.displayName),n.avatar&&(this.avatar=n.avatar),this.avatarHalo=Object(l.a)(n)),o.abrupt("break",36);case 36:case"end":return o.stop()}}),null,this)}}},w=n(273),v=n(279),L=n(272),m=n(275),S=n(260),C={name:"embed-id-button",layout:"embedv2",components:{Identity:w.a,LikeCoinButtonWidget:v.c,LikeButton:L.a,SaveButton:m.a},mixins:[f],data:function(){return{isUserFetched:!1,isShowAltMode:!1}},computed:{widgetLayout:function(){if(this.isShowAltMode){var e=this.$route.query.mode;if(v.a.includes(e))return e}return v.b},hasAltMode:function(){var e=this.$route.query.mode;return v.a.includes(e)&&e!==v.b}},mounted:function(){this.hasAltMode&&(this.isShowAltMode=!0,window.addEventListener("message",this.onReceiveMessage,!1))},beforeDestory:function(){window.removeEventListener("message",this.onReceiveMessage,!1)},methods:{doLogin:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.isPreview){n.next=2;break}return n.abrupt("return");case 2:if(this.postSignInAction=e,!(!this.hasCookieSupport||Object(r.f)()&&Object(r.g)())){n.next=18;break}if(this.openPopup(e),t=e.replace(/^./,(function(s){return s.toUpperCase()})),Object(S.a)(this,"LikeButtonFlow","popup".concat(t),"popup".concat(t,"(embed)"),1),this.hasStorageAPIAccess){n.next=16;break}return n.next=10,regeneratorRuntime.awrap(Object(r.h)());case 10:if(!n.sent){n.next=16;break}return n.next=13,regeneratorRuntime.awrap(this.getIsCookieSupport());case 13:return this.hasCookieSupport=n.sent,n.next=16,regeneratorRuntime.awrap(this.updateUserSignInStatus());case 16:n.next=20;break;case 18:this.signUp(),Object(S.a)(this,"LikeButtonFlow","popupSignUp","popupSignUp(embed)",1);case 20:case"end":return n.stop()}}),null,this)},doLike:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isMaxLike||this.isCreator){e.next=5;break}this.like(),Object(S.a)(this,"LikeButtonFlow","clickLike","clickLike(embed)",1),e.next=13;break;case 5:if(!this.canSuperLike){e.next=12;break}return e.next=8,regeneratorRuntime.awrap(this.newSuperLike());case 8:return e.next=10,regeneratorRuntime.awrap(this.updateSuperLikeStatus());case 10:e.next=13;break;case 12:this.showCivicLikerCTA();case 13:case"end":return e.stop()}}),null,this)},getShouldShowCivicLikerCTA:function(){if(void 0===this.ctaClickCount)this.ctaClickCount=1;else if(this.ctaClickCount=(this.ctaClickCount+1)%5,0!==this.ctaClickCount)return!1;return!0},showCivicLikerCTA:function(){this.getShouldShowCivicLikerCTA()&&(this.goToPortfolio({type:"popup",target:"civic-liker-cta",feature:"width=540,height=640,menubar=no,location=no,resizable=yes,scrollbars=yes,status=yes"}),Object(S.a)(this,"LikeButtonFlow","clickCivicLikerCTA","clickCivicLikerCTA(embed)",1))},onClickLike:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(S.a)(this,"LikeButtonFlow","clickLikeButton","clickLikeButton(embed)",1),!this.isLoggedIn){e.next=5;break}this.doLike(),e.next=7;break;case 5:return e.next=7,regeneratorRuntime.awrap(this.doLogin("like"));case 7:case"end":return e.stop()}}),null,this)},onClickLikeStats:function(){this.openLikeStats(),Object(S.a)(this,"LikeButtonFlow","clickLikeStats","clickLikeStats(embed)",1)},onClickAvatar:function(){Object(S.a)(this,"LikeButtonFlow","clickAvatar","clickAvatar(embed)",1),this.goToPortfolio()},onClickSaveButton:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(S.a)(this,"LikeButtonFlow","clickSaveButton","clickSaveButton(embed)",1),!this.isLoggedIn){e.next=5;break}this.toggleBookmark(),e.next=7;break;case 5:return e.next=7,regeneratorRuntime.awrap(this.doLogin("save"));case 7:case"end":return e.stop()}}),null,this)},handleMessageAction:function(e,t){switch(t){case"showAltMode":this.isShowAltMode=!0;break;case"hideAltMode":this.isShowAltMode=!1}e&&e.source&&e.source.postMessage(JSON.stringify({ack:t}),e.origin)},onReceiveMessage:function(e){var t=this,n=[];try{n=JSON.parse(e.data).actions}catch(e){return void console.error(e)}Array.isArray(n)?n.forEach((function(n){t.handleMessageAction(e,n)})):this.handleMessageAction(e,n)}}},y=n(19),component=Object(y.a)(C,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("LikeCoinButtonWidget",{attrs:{layout:e.widgetLayout,"like-button-label":e.likeButtonLabel,"cta-button-label":e.ctaButtonLabel,"cta-button-preset":e.ctaButtonPreset,"hint-label":e.hintText,"is-show-like-button":e.isShowLikeButton},on:{"click-like-button-label":e.onClickLikeStats,"click-cta-button":e.onClickCTAButton},scopedSlots:e._u([{key:"like-button",fn:function(){return[n("LikeButton",{ref:"likeButton",attrs:{count:e.likeCount,cooldown:e.cooldownProgress,"cooldown-end-time":e.nextSuperLikeTime,"has-super-liked":e.hasSuperLiked,"is-just-super-liked":e.isJustSuperLiked,"is-super-like-enabled":e.isSuperLiker,"is-creator":e.isCreator},on:{click:e.onClickLike,"click-disabled":e.onClickCooldown,"cooldown-end":e.updateSuperLikeStatus}})]},proxy:!0},{key:"save-button",fn:function(t){return[n("SaveButton",e._b({attrs:{toggled:e.hasBookmarked},on:{click:e.onClickSaveButton}},"SaveButton",t,!1))]}},{key:"identity",fn:function(t){return[n("Identity",e._b({attrs:{avatarURL:e.avatar,"display-name":e.displayName,"is-avatar-button-outlined":e.isCreatorCivicLiker},on:{"click-avatar":e.onClickAvatar,"click-display-name":e.onClickAvatar}},"Identity",t,!1))]}}])})],1)}),[],!1,null,null,null);t.default=component.exports}}]);
//# sourceMappingURL=45edf664951ca9249b26.js.map